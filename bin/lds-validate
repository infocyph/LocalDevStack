#!/usr/bin/env bash
set -euo pipefail

ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
# shellcheck disable=SC1090
source "$ROOT/lib/bootstrap.sh"
# shellcheck disable=SC1090
source "$ROOT/lib/io.sh"
# shellcheck disable=SC1090
source "$ROOT/lib/docker.sh"
# shellcheck disable=SC1090
source "$ROOT/lib/docker_exec.sh"
# shellcheck disable=SC1090
source "$ROOT/lib/env.sh"
# shellcheck disable=SC1090
source "$ROOT/lib/validate.sh"

sub="${1:-all}"; shift || true
case "$sub" in
  all) lds_validate_compose; lds_validate_env; lds_validate_profiles;;
  compose) lds_validate_compose;;
  env) lds_validate_env;;
  profiles) lds_validate_profiles;;
  *) die "validate <all|compose|env|profiles>";;
esac
